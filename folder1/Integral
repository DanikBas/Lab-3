clear; clc;close all;


%Integral function
b = 36; %feet
CHORD_ROOT = 5 + (4/12); %feet
C_t = 3 + (7/12); %feet
PLANFORM_AREA_S = .5*(CHORD_ROOT*C_t)*b; 
cd_fit_tip = 2;

y = linspace(0,b,(b/100));
%fun = @(y)cd_fit_tip(y)*c(y);

%CD_0 = (1/S)*integral(fun,(-b/2),(b/2));

% Also chord distirubtion along the wing span
 
% span is 36 ft
%middle section is 16 ft 8 in
%so the outside lengths are 9' 8''

%c_init = linspace(c_r,c_t,116);
%116 is the amount of inches from 9' 8''

%c_fin = linspace(c_t,c_r,116);

%% 3. Perform Numerical Integration

% Define the limits of integration: from -b/2 to b/2
B_HALF = b / 2.0;
TAPER_RATIO = C_t/CHORD_ROOT;
ALPHA_INCIDENCE = deg2rad(5.0); % Angle of Attack (AoA) for the calculation [rad]
    A0_SECTION = 6.28;               % Sectional Lift Curve Slope (a0 = 2*pi) [per rad]
    ALPHA_L0 = deg2rad(-2.0);        % Zero-lift angle of attack [rad]
    CD_MIN_PROFILE = 0.006;          % Minimum sectional profile drag (cd_min)
    K_POLAR = 0.015;                 % Constant K for parabolic drag polar (cd = cd_min + K*cl^2)

% Create an anonymous function handle for the integrand. 
% This tells the 'integral' function which helper function to use (integrand_func).
integrand = @(y) integrand_func(y, b, CHORD_ROOT, TAPER_RATIO,ALPHA_INCIDENCE, A0_SECTION, ALPHA_L0,CD_MIN_PROFILE, K_POLAR);

% Calculate the integral of [cd(y) * c(y)] dy
Integral_Result = integral(integrand, -B_HALF, B_HALF);

% Calculate the Profile Drag Coefficient (CD,0)
C_D0_PROFILE = (1 / PLANFORM_AREA_S) * Integral_Result;

function output = integrand_func(y, b, c_root, taper_ratio,alpha_incidence, a0, alpha_l0, cd_min, K_polar)
% INTEGRAND_FUNC: Calculates the value of the integrand [cd(y) * c(y)].
% 
% INPUTS:
%   y: Spanwise position (integration variable, passed as a vector by 'integral')
%   ... other geometric and aerodynamic constants ...

    % --- A. Calculate Local Chord c(y) (Linear Taper) ---
    % All operations must be element-wise (using .*, ./, etc.)
    
    b_half = b / 2.0; 
    c_tip = c_root * taper_ratio; 
    
    % The fraction of the semi-span we are at (from 0 to 1)
    % abs(y) ensures symmetry from -b/2 to b/2
    y_over_bhalf = abs(y) ./ b_half;
    
    % Linear interpolation between c_root and c_tip
    c_local = c_root - (c_root - c_tip) .* y_over_bhalf;


    % --- B. Calculate Local Sectional Drag cd(y) ---
    % Assumption: No aerodynamic twist (alpha_local = alpha_incidence)
    alpha_local = alpha_incidence; 

    % 1. Calculate local sectional lift coefficient (cl)
    % cl = a0 * (alpha_local - alpha_l0)
    cl_local = a0 * (alpha_local - alpha_l0); 
    
    % 2. Calculate local sectional drag coefficient (cd) using parabolic polar
    % cd = cd_min + K_polar * cl^2. Use element-wise power .^2
    cd_local = cd_min + K_polar .* cl_local.^2;


    % --- C. Final Integrand Value ---
    % Element-wise multiplication to produce the output vector
    output = cd_local .* c_local; 
end



